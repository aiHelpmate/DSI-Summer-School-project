2025-08-12 18:42:58,705 - INFO - Using device: cuda
2025-08-12 18:42:58,707 - INFO - PyTorch version: 2.7.0+cu118
2025-08-12 18:42:58,708 - INFO - NumPy version: 2.2.6
2025-08-12 18:42:58,709 - INFO - OpenCV version: 4.12.0
2025-08-12 18:43:56,055 - INFO - 找到 210 个病例
2025-08-12 18:43:56,056 - INFO - 确定性切分: 168 个训练病例, 42 个验证病例
2025-08-12 18:43:56,057 - INFO - 训练病例: ['001', '002', '003', '004', '005']...
2025-08-12 18:43:56,058 - INFO - 验证病例: ['169', '170', '171', '172', '173']...
2025-08-12 18:43:56,061 - INFO - 最终训练数据: 168 个样本
2025-08-12 18:43:56,061 - INFO - 最终验证数据: 42 个样本
2025-08-12 18:43:56,062 - INFO - 准备好的训练数据数量: 168
2025-08-12 18:43:56,063 - INFO - 准备好的验证数据数量: 42
2025-08-12 18:43:56,064 - INFO - 正在创建数据加载器...
2025-08-12 18:43:56,065 - INFO - Train dataset size: 168
2025-08-12 18:43:56,065 - INFO - Validation dataset size: 42
2025-08-12 18:43:56,067 - INFO - Train batches: 42
2025-08-12 18:43:56,068 - INFO - Validation batches: 11
2025-08-12 18:43:56,069 - INFO - 训练批次数量: 42
2025-08-12 18:43:56,070 - INFO - 验证批次数量: 11
2025-08-12 18:43:56,071 - INFO - 正在创建 U-Net 模型...
2025-08-12 18:43:56,402 - INFO - 模型信息:
2025-08-12 18:43:56,411 - INFO - 开始训练模型...
2025-08-12 18:43:56,413 - INFO - 开始训练模型...
2025-08-12 18:43:56,414 - INFO - 训练轮数: 30
2025-08-12 18:43:56,415 - INFO - 学习率: 0.001
2025-08-12 18:43:56,416 - INFO - 设备: cuda
2025-08-12 18:44:08,545 - INFO - Epoch 1/30:
2025-08-12 18:44:08,546 - INFO -   Train Loss: 0.6680, Train Dice: 0.7502
2025-08-12 18:44:08,547 - INFO -   Val Loss: 0.4532, Val Dice: 0.9479
2025-08-12 18:44:08,548 - INFO -   Learning Rate: 0.001000
2025-08-12 18:44:08,753 - INFO -   新的最佳模型已保存! Val Dice: 0.9479
2025-08-12 18:44:21,510 - INFO - Epoch 2/30:
2025-08-12 18:44:21,511 - INFO -   Train Loss: 0.3890, Train Dice: 0.9398
2025-08-12 18:44:21,513 - INFO -   Val Loss: 0.3525, Val Dice: 0.9441
2025-08-12 18:44:21,514 - INFO -   Learning Rate: 0.001000
2025-08-12 18:44:31,216 - INFO - Epoch 3/30:
2025-08-12 18:44:31,217 - INFO -   Train Loss: 0.3353, Train Dice: 0.9406
2025-08-12 18:44:31,218 - INFO -   Val Loss: 0.3288, Val Dice: 0.9299
2025-08-12 18:44:31,219 - INFO -   Learning Rate: 0.001000
2025-08-12 18:44:41,583 - INFO - Epoch 4/30:
2025-08-12 18:44:41,584 - INFO -   Train Loss: 0.3198, Train Dice: 0.9404
2025-08-12 18:44:41,585 - INFO -   Val Loss: 0.3073, Val Dice: 0.9523
2025-08-12 18:44:41,586 - INFO -   Learning Rate: 0.001000
2025-08-12 18:44:41,838 - INFO -   新的最佳模型已保存! Val Dice: 0.9523
2025-08-12 18:44:54,810 - INFO - Epoch 5/30:
2025-08-12 18:44:54,811 - INFO -   Train Loss: 0.3107, Train Dice: 0.9452
2025-08-12 18:44:54,812 - INFO -   Val Loss: 0.2986, Val Dice: 0.9567
2025-08-12 18:44:54,813 - INFO -   Learning Rate: 0.001000
2025-08-12 18:44:54,966 - INFO -   新的最佳模型已保存! Val Dice: 0.9567
2025-08-12 18:45:04,535 - INFO - Epoch 6/30:
2025-08-12 18:45:04,535 - INFO -   Train Loss: 0.3095, Train Dice: 0.9450
2025-08-12 18:45:04,536 - INFO -   Val Loss: 0.3031, Val Dice: 0.9504
2025-08-12 18:45:04,537 - INFO -   Learning Rate: 0.001000
2025-08-12 18:45:14,630 - INFO - Epoch 7/30:
2025-08-12 18:45:14,631 - INFO -   Train Loss: 0.3105, Train Dice: 0.9395
2025-08-12 18:45:14,632 - INFO -   Val Loss: 0.3015, Val Dice: 0.9484
2025-08-12 18:45:14,633 - INFO -   Learning Rate: 0.001000
2025-08-12 18:45:27,507 - INFO - Epoch 8/30:
2025-08-12 18:45:27,507 - INFO -   Train Loss: 0.3055, Train Dice: 0.9439
2025-08-12 18:45:27,508 - INFO -   Val Loss: 0.2987, Val Dice: 0.9543
2025-08-12 18:45:27,509 - INFO -   Learning Rate: 0.001000
2025-08-12 18:45:37,089 - INFO - Epoch 9/30:
2025-08-12 18:45:37,090 - INFO -   Train Loss: 0.3014, Train Dice: 0.9488
2025-08-12 18:45:37,090 - INFO -   Val Loss: 0.3052, Val Dice: 0.9433
2025-08-12 18:45:37,091 - INFO -   Learning Rate: 0.001000
2025-08-12 18:45:46,508 - INFO - Epoch 10/30:
2025-08-12 18:45:46,509 - INFO -   Train Loss: 0.3026, Train Dice: 0.9455
2025-08-12 18:45:46,509 - INFO -   Val Loss: 0.3246, Val Dice: 0.9234
2025-08-12 18:45:46,510 - INFO -   Learning Rate: 0.001000
2025-08-12 18:45:59,287 - INFO - Epoch 11/30:
2025-08-12 18:45:59,288 - INFO -   Train Loss: 0.3053, Train Dice: 0.9436
2025-08-12 18:45:59,289 - INFO -   Val Loss: 0.3007, Val Dice: 0.9486
2025-08-12 18:45:59,290 - INFO -   Learning Rate: 0.000500
2025-08-12 18:46:09,523 - INFO - Epoch 12/30:
2025-08-12 18:46:09,524 - INFO -   Train Loss: 0.2990, Train Dice: 0.9500
2025-08-12 18:46:09,525 - INFO -   Val Loss: 0.2938, Val Dice: 0.9563
2025-08-12 18:46:09,526 - INFO -   Learning Rate: 0.000500
2025-08-12 18:46:19,494 - INFO - Epoch 13/30:
2025-08-12 18:46:19,495 - INFO -   Train Loss: 0.2993, Train Dice: 0.9489
2025-08-12 18:46:19,497 - INFO -   Val Loss: 0.2916, Val Dice: 0.9587
2025-08-12 18:46:19,497 - INFO -   Learning Rate: 0.000500
2025-08-12 18:46:19,719 - INFO -   新的最佳模型已保存! Val Dice: 0.9587
2025-08-12 18:46:32,631 - INFO - Epoch 14/30:
2025-08-12 18:46:32,632 - INFO -   Train Loss: 0.3013, Train Dice: 0.9465
2025-08-12 18:46:32,633 - INFO -   Val Loss: 0.2969, Val Dice: 0.9532
2025-08-12 18:46:32,634 - INFO -   Learning Rate: 0.000500
2025-08-12 18:46:43,217 - INFO - Epoch 15/30:
2025-08-12 18:46:43,218 - INFO -   Train Loss: 0.3006, Train Dice: 0.9461
2025-08-12 18:46:43,218 - INFO -   Val Loss: 0.2933, Val Dice: 0.9591
2025-08-12 18:46:43,218 - INFO -   Learning Rate: 0.000500
2025-08-12 18:46:43,421 - INFO -   新的最佳模型已保存! Val Dice: 0.9591
2025-08-12 18:46:53,699 - INFO - Epoch 16/30:
2025-08-12 18:46:53,700 - INFO -   Train Loss: 0.2958, Train Dice: 0.9535
2025-08-12 18:46:53,701 - INFO -   Val Loss: 0.2969, Val Dice: 0.9506
2025-08-12 18:46:53,702 - INFO -   Learning Rate: 0.000500
2025-08-12 18:47:06,756 - INFO - Epoch 17/30:
2025-08-12 18:47:06,757 - INFO -   Train Loss: 0.2998, Train Dice: 0.9473
2025-08-12 18:47:06,758 - INFO -   Val Loss: 0.2935, Val Dice: 0.9576
2025-08-12 18:47:06,758 - INFO -   Learning Rate: 0.000500
2025-08-12 18:47:17,145 - INFO - Epoch 18/30:
2025-08-12 18:47:17,146 - INFO -   Train Loss: 0.2967, Train Dice: 0.9525
2025-08-12 18:47:17,146 - INFO -   Val Loss: 0.2903, Val Dice: 0.9600
2025-08-12 18:47:17,148 - INFO -   Learning Rate: 0.000500
2025-08-12 18:47:17,363 - INFO -   新的最佳模型已保存! Val Dice: 0.9600
2025-08-12 18:47:27,375 - INFO - Epoch 19/30:
2025-08-12 18:47:27,376 - INFO -   Train Loss: 0.2962, Train Dice: 0.9513
2025-08-12 18:47:27,377 - INFO -   Val Loss: 0.2905, Val Dice: 0.9597
2025-08-12 18:47:27,378 - INFO -   Learning Rate: 0.000500
2025-08-12 18:47:39,742 - INFO - Epoch 20/30:
2025-08-12 18:47:39,742 - INFO -   Train Loss: 0.2993, Train Dice: 0.9478
2025-08-12 18:47:39,743 - INFO -   Val Loss: 0.2969, Val Dice: 0.9493
2025-08-12 18:47:39,744 - INFO -   Learning Rate: 0.000500
2025-08-12 18:47:49,725 - INFO - Epoch 21/30:
2025-08-12 18:47:49,726 - INFO -   Train Loss: 0.2962, Train Dice: 0.9517
2025-08-12 18:47:49,726 - INFO -   Val Loss: 0.2893, Val Dice: 0.9597
2025-08-12 18:47:49,727 - INFO -   Learning Rate: 0.000500
2025-08-12 18:47:59,470 - INFO - Epoch 22/30:
2025-08-12 18:47:59,471 - INFO -   Train Loss: 0.2955, Train Dice: 0.9511
2025-08-12 18:47:59,472 - INFO -   Val Loss: 0.2902, Val Dice: 0.9588
2025-08-12 18:47:59,472 - INFO -   Learning Rate: 0.000500
2025-08-12 18:48:09,407 - INFO - Epoch 23/30:
2025-08-12 18:48:09,407 - INFO -   Train Loss: 0.2962, Train Dice: 0.9520
2025-08-12 18:48:09,408 - INFO -   Val Loss: 0.2983, Val Dice: 0.9479
2025-08-12 18:48:09,409 - INFO -   Learning Rate: 0.000500
2025-08-12 18:48:22,283 - INFO - Epoch 24/30:
2025-08-12 18:48:22,284 - INFO -   Train Loss: 0.2999, Train Dice: 0.9466
2025-08-12 18:48:22,284 - INFO -   Val Loss: 0.3017, Val Dice: 0.9428
2025-08-12 18:48:22,285 - INFO -   Learning Rate: 0.000250
2025-08-12 18:48:32,070 - INFO - Epoch 25/30:
2025-08-12 18:48:32,071 - INFO -   Train Loss: 0.2950, Train Dice: 0.9508
2025-08-12 18:48:32,072 - INFO -   Val Loss: 0.2895, Val Dice: 0.9602
2025-08-12 18:48:32,073 - INFO -   Learning Rate: 0.000250
2025-08-12 18:48:32,265 - INFO -   新的最佳模型已保存! Val Dice: 0.9602
2025-08-12 18:48:42,622 - INFO - Epoch 26/30:
2025-08-12 18:48:42,622 - INFO -   Train Loss: 0.2940, Train Dice: 0.9532
2025-08-12 18:48:42,623 - INFO -   Val Loss: 0.2887, Val Dice: 0.9603
2025-08-12 18:48:42,624 - INFO -   Learning Rate: 0.000250
2025-08-12 18:48:42,837 - INFO -   新的最佳模型已保存! Val Dice: 0.9603
2025-08-12 18:48:55,586 - INFO - Epoch 27/30:
2025-08-12 18:48:55,587 - INFO -   Train Loss: 0.2935, Train Dice: 0.9546
2025-08-12 18:48:55,588 - INFO -   Val Loss: 0.2895, Val Dice: 0.9596
2025-08-12 18:48:55,589 - INFO -   Learning Rate: 0.000250
2025-08-12 18:49:05,870 - INFO - Epoch 28/30:
2025-08-12 18:49:05,871 - INFO -   Train Loss: 0.2920, Train Dice: 0.9550
2025-08-12 18:49:05,872 - INFO -   Val Loss: 0.2871, Val Dice: 0.9627
2025-08-12 18:49:05,872 - INFO -   Learning Rate: 0.000250
2025-08-12 18:49:06,069 - INFO -   新的最佳模型已保存! Val Dice: 0.9627
2025-08-12 18:49:16,531 - INFO - Epoch 29/30:
2025-08-12 18:49:16,531 - INFO -   Train Loss: 0.2953, Train Dice: 0.9502
2025-08-12 18:49:16,532 - INFO -   Val Loss: 0.2880, Val Dice: 0.9612
2025-08-12 18:49:16,533 - INFO -   Learning Rate: 0.000250
2025-08-12 18:49:29,194 - INFO - Epoch 30/30:
2025-08-12 18:49:29,195 - INFO -   Train Loss: 0.2963, Train Dice: 0.9494
2025-08-12 18:49:29,196 - INFO -   Val Loss: 0.2888, Val Dice: 0.9620
2025-08-12 18:49:29,197 - INFO -   Learning Rate: 0.000250
2025-08-12 18:49:29,197 - INFO - 训练完成! 最佳验证Dice系数: 0.9627
2025-08-12 18:49:29,201 - INFO - 模型训练脚本执行完毕。
